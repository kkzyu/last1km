import{c as a,a as r,b as e,f as z,t as u,g as R,h as j,F as x,d as C,e as N,n as S,r as h,o as T,j as P,v as D,p as B,k as E,i as I,u as K}from"./index-vt05okdP.js";import{_ as b}from"./_plugin-vue_export-helper-DlAUqK2U.js";const M={class:"rider-info-card"},q=["src"],V={class:"rider-name-display"},A={key:0,class:"rider-bio-display"},U={__name:"RiderInfoCard",props:{rider:{type:Object,required:!0,default:()=>({name:"加载中...",avatar:""})}},setup(s){return(w,o)=>(r(),a("div",M,[e("img",{src:s.rider.avatar||"/avatars/default.png",alt:"Rider Avatar",class:"rider-avatar-display"},null,8,q),e("h3",V,u(s.rider.name),1),s.rider.bio?(r(),a("p",A,u(s.rider.bio),1)):z("",!0)]))}},W=b(U,[["__scopeId","data-v-058d0a3a"]]),G={class:"rider-stats-panel-card"},J={class:"stats-grid"},Q={class:"stat-item"},X={class:"stat-value"},Y={class:"stat-item"},Z={class:"stat-value"},ee={class:"stat-item"},te={class:"stat-value"},se={class:"stat-item"},re={class:"stat-value"},ae={__name:"RiderStatsPanel",props:{stats:{type:Object,required:!0,default:()=>({onTimeRate:0,positiveFeedbackRate:0,averageDailyOrders:0,likeCount:0})}},setup(s){return(w,o)=>(r(),a("div",G,[e("div",J,[e("div",Q,[e("span",X,u((s.stats.onTimeRate*100).toFixed(0))+"%",1),o[0]||(o[0]=e("span",{class:"stat-label"},"准时率",-1))]),e("div",Y,[e("span",Z,u((s.stats.positiveFeedbackRate*100).toFixed(0))+"%",1),o[1]||(o[1]=e("span",{class:"stat-label"},"好评率",-1))]),e("div",ee,[e("span",te,u(s.stats.averageDailyOrders),1),o[2]||(o[2]=e("span",{class:"stat-label"},"日均送单",-1))]),e("div",se,[e("span",re,[o[3]||(o[3]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",class:"like-icon"},[e("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})],-1)),R(" "+u(s.stats.likeCount),1)]),o[4]||(o[4]=e("span",{class:"stat-label"},"点赞数",-1))])])]))}},oe=b(ae,[["__scopeId","data-v-c5325643"]]),ie={class:"word-cloud-square-card"},ne={key:0,class:"keywords-container"},le={key:1,class:"no-keywords"},de={__name:"WordCloud",props:{keywords:{type:Array,required:!0,default:()=>[]}},setup(s){const w=s,o=j(()=>[...w.keywords].sort((i,n)=>n.weight-i.weight)),t=i=>{const _=Math.max(...w.keywords.map(p=>p.weight).filter(Number.isFinite),5),y=Math.min(...w.keywords.map(p=>p.weight).filter(Number.isFinite),1);let f=.5;return _>y?f=.5+(i-y)/(_-y)*(1-.5):w.keywords.length>0&&(f=(.5+1)/2),{fontSize:`${Math.max(.5,Math.min(1,f))}em`}},c=i=>i==="positive"?"sentiment-positive":i==="negative"?"sentiment-negative":"sentiment-neutral";return(i,n)=>(r(),a("div",ie,[n[0]||(n[0]=e("h4",null,"用户评价",-1)),s.keywords&&s.keywords.length?(r(),a("div",ne,[(r(!0),a(x,null,C(o.value,v=>(r(),a("span",{key:v.text,class:S(["keyword-tag",c(v.sentiment)]),style:N(t(v.weight))},u(v.text),7))),128))])):(r(),a("p",le,"暂无评价关键词"))]))}},ue=b(de,[["__scopeId","data-v-ffd5e5bd"]]),ce={class:"order-history-item-card"},ve={class:"order-header"},me={class:"review-section"},fe={key:0},we={class:"rating-stars"},_e=["onClick"],he=["disabled"],ye=["disabled"],ge={key:1,class:"existing-review"},ke={class:"rating-stars static"},pe={key:2,class:"no-review-placeholder"},$e={__name:"OrderHistoryItem",props:{order:{type:Object,required:!0}},emits:["submit-review"],setup(s,{emit:w}){const o=s,t=w,c=h(0),i=h(""),n=h(!1),v=h(!1),_=h(null);T(()=>{o.order.userReview&&(_.value={...o.order.userReview},c.value=o.order.userReview.rating,i.value=o.order.userReview.comment,n.value=!0)});const y=k=>{const l={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(k).toLocaleDateString("zh-CN",l)},f=k=>{n.value||(c.value=k)},p=()=>{c.value===0||v.value||(v.value=!0,setTimeout(()=>{const k={rating:c.value,comment:i.value.trim()};t("submit-review",{orderId:o.order.orderId,review:k}),_.value=k,n.value=!0,v.value=!1},500))};return(k,l)=>(r(),a("div",ce,[e("div",ve,[e("h4",null,"订单号: "+u(s.order.orderId),1),e("span",null,u(y(s.order.date)),1)]),e("p",null,[l[1]||(l[1]=e("strong",null,"餐厅:",-1)),R(" "+u(s.order.restaurantName),1)]),e("p",null,[l[2]||(l[2]=e("strong",null,"商品:",-1)),R(" "+u(s.order.items.join(", ")),1)]),e("p",null,[l[3]||(l[3]=e("strong",null,"金额:",-1)),R(" ¥"+u(s.order.totalAmount.toFixed(2)),1)]),e("div",me,[l[7]||(l[7]=e("h5",null,"评价此订单",-1)),!n.value&&!s.order.userReview?(r(),a("div",fe,[e("div",we,[(r(),a(x,null,C(5,g=>e("span",{key:g,onClick:O=>f(g),class:S({filled:g<=c.value,interactive:!n.value})}," ★ ",10,_e)),64))]),P(e("textarea",{"onUpdate:modelValue":l[0]||(l[0]=g=>i.value=g),placeholder:"写下您的评价 (可选)",rows:"3",disabled:n.value},null,8,he),[[D,i.value]]),e("button",{onClick:p,disabled:c.value===0||v.value},u(v.value?"提交中...":"提交评价"),9,ye)])):_.value?(r(),a("div",ge,[e("p",null,[l[4]||(l[4]=e("strong",null,"您的评分:",-1)),e("span",ke,[(r(),a(x,null,C(5,g=>e("span",{key:g,class:S({filled:g<=_.value.rating})},"★",2)),64))])]),e("p",null,[l[5]||(l[5]=e("strong",null,"您的评价:",-1)),R(" "+u(_.value.comment||"无"),1)])])):(r(),a("div",pe,l[6]||(l[6]=[e("p",null,"您尚未评价此订单。",-1)])))])]))}},be=b($e,[["__scopeId","data-v-6591d839"]]),Re={class:"rider-order-history"},xe={key:0,class:"loading-state"},Ce={key:1,class:"error-state"},Se={key:2},Ie={key:3,class:"empty-state"},Fe={__name:"RiderOrderHistory",props:{orders:{type:Array,default:()=>[]},isLoading:{type:Boolean,default:!1},error:{type:String,default:null}},emits:["order-reviewed"],setup(s,{emit:w}){const o=w,t=c=>{console.log("Review submitted in RiderOrderHistory:",c),o("order-reviewed",c)};return(c,i)=>(r(),a("div",Re,[i[1]||(i[1]=e("h3",null,"我的历史送单",-1)),s.isLoading?(r(),a("div",xe,"加载历史订单中...")):s.error?(r(),a("div",Ce,u(s.error),1)):s.orders&&s.orders.length?(r(),a("div",Se,[(r(!0),a(x,null,C(s.orders,n=>(r(),B(be,{key:n.orderId,order:n,onSubmitReview:t},null,8,["order"]))),128))])):(r(),a("div",Ie,i[0]||(i[0]=[e("p",null,"这位送餐员还没有为您送过订单。",-1)])))]))}},ze=b(Fe,[["__scopeId","data-v-17237ef4"]]),Oe={class:"rider-profile-page"},je={class:"profile-page-header"},Te={class:"page-title"},Be={key:0,class:"loading-indicator"},He={key:1,class:"error-message"},Le={key:2,class:"profile-content-scrollable"},Ne={class:"profile-main-layout"},Pe={class:"left-column"},De={class:"right-column"},Ee={key:3,class:"not-found"},Ke={key:4,class:"profile-actions"},F="user_abc",Me={__name:"RiderProfilePage",setup(s){const w=E(),o=K(),t=h(null),c=h(!0),i=h(null),n=h([]),v=h(!0),_=h(null),y=h(!1),f=j(()=>w.params.riderId||"rider_1");async function p(){c.value=!0,i.value=null;try{const d=await fetch("/data/riders.json");if(!d.ok)throw new Error(`HTTP error! status: ${d.status}`);const m=await d.json();if(m[f.value])t.value={...m[f.value]},t.value.stats||(t.value.stats={likeCount:0,reviewKeywords:[]}),t.value.stats.reviewKeywords||(t.value.stats.reviewKeywords=[]),y.value=localStorage.getItem(`liked_rider_${f.value}`)==="true";else throw new Error("Rider not found")}catch(d){console.error("Failed to fetch rider data:",d),i.value=d.message,t.value=null}finally{c.value=!1}}async function k(){if(t.value){v.value=!0,_.value=null;try{const d=await fetch("/data/orders.json");if(!d.ok)throw new Error(`HTTP error! status: ${d.status}`);const m=await d.json();m[F]&&m[F][f.value]?n.value=m[F][f.value].map($=>({...$,userReview:$.userReview||null})):n.value=[]}catch(d){console.error("Failed to fetch order history:",d),_.value=d.message}finally{v.value=!1}}}T(async()=>{await p(),t.value&&await k()});const l=()=>{o.go(-1)},g=()=>{t.value&&alert(`已将送餐员 ${t.value.name} 加入黑名单 (模拟操作)`)},O=()=>{t.value&&o.push({name:"ChatPage",params:{chatId:`chat_${t.value.id}`}})},H=()=>{!t.value||!t.value.stats||(y.value?(t.value.stats.likeCount--,y.value=!1,localStorage.removeItem(`liked_rider_${f.value}`),alert(`已取消点赞 ${t.value.name} (模拟操作)`)):(t.value.stats.likeCount++,y.value=!0,localStorage.setItem(`liked_rider_${f.value}`,"true"),alert(`已点赞 ${t.value.name}! (模拟操作)`)))},L=d=>{const m=n.value.findIndex($=>$.orderId===d.orderId);m!==-1&&(n.value[m].userReview=d.review)};return(d,m)=>{var $;return r(),a("div",Oe,[e("header",je,[e("button",{onClick:l,class:"back-button","aria-label":"返回"},m[0]||(m[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"15 18 9 12 15 6"})],-1)])),e("h4",Te,u((($=t.value)==null?void 0:$.name)||"送餐员主页"),1),m[1]||(m[1]=e("div",{class:"header-placeholder"},null,-1))]),c.value?(r(),a("div",Be,"正在加载送餐员信息...")):i.value?(r(),a("div",He,"错误: "+u(i.value),1)):t.value?(r(),a("div",Le,[e("div",Ne,[e("div",Pe,[I(W,{rider:t.value},null,8,["rider"]),I(oe,{stats:t.value.stats},null,8,["stats"])]),e("div",De,[t.value.stats&&t.value.stats.reviewKeywords?(r(),B(ue,{key:0,keywords:t.value.stats.reviewKeywords},null,8,["keywords"])):z("",!0)])]),I(ze,{orders:n.value,"is-loading":v.value,error:_.value,onOrderReviewed:L},null,8,["orders","is-loading","error"])])):(r(),a("div",Ee,"未找到送餐员信息。")),t.value?(r(),a("footer",Ke,[e("button",{onClick:g,class:"action-button block"},"拉黑"),e("button",{onClick:O,class:"action-button contact"},"联系"),e("button",{onClick:H,class:S(["action-button like",{liked:y.value}])},"点赞",2)])):z("",!0)])}}},Ae=b(Me,[["__scopeId","data-v-3a5381bd"]]);export{Ae as default};
