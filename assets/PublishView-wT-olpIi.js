import{A as B,r as g,h as f,c as h,a as k,b as e,u as T,t as q,j as x,B as N,v as w,f as y,g as F,o as M,i as C,q as $,F as D,d as O}from"./index-vt05okdP.js";import{i as j}from"./information-CctnqRBX.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";const S=B("order",()=>{const d=g("home"),i=g([]),a=g(!1),n=g([]),v=g(!1),p=g([]),m=f(()=>{const o={};return i.value.forEach(t=>{o[t.date]||(o[t.date]=[]),o[t.date].push(t)}),o});function c(){i.value=j.orders}function s(o){d.value=o,console.log("切换到标签:",o)}function r(){const o={id:p.value.length+1,origin:"",destination:"",description:"",image:null,orderInfo:"",amount:0};return p.value.push(o),console.log("当前请求列表：",p.value),o}function u(){console.log("发布新委托")}function b(){a.value=!0}function _(o){v.value=o,o?n.value=[...i.value]:n.value=[]}function I(o){const t=n.value.findIndex(l=>l.id===o.id);t===-1?n.value.push(o):n.value.splice(t,1),v.value=n.value.length===i.value.length}const R=f(()=>n.value.reduce((o,t)=>o+(t.amount||0),0));return{activeTab:d,orders:i,imageFailed:a,selectedOrders:n,selectAll:v,requests:p,groupedOrders:m,totalAmount:R,loadOrders:c,handleTabChange:s,publishNewOrder:u,handleImageError:b,toggleSelectAll:_,toggleOrderSelection:I,addRequest:r}}),E={class:"action-header-container"},L={__name:"AddRequestButton",emits:["add-request-clicked"],setup(d,{emit:i}){const a=T(),n=i,v=()=>{n("add-request-clicked")},p=()=>{a.push("/home")};return(m,c)=>(k(),h("div",E,[e("button",{class:"btn return-btn",onClick:p},c[0]||(c[0]=[e("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"icon"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),e("span",null,null,-1)])),e("button",{class:"btn add-btn",onClick:v},c[1]||(c[1]=[e("span",null,"添加委托",-1),e("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"icon"},[e("path",{d:"M12 5v14M5 12h14"})],-1)]))]))}},H=A(L,[["__scopeId","data-v-8da09ea5"]]),P={class:"request-details-form"},z={class:"task-header"},G={class:"task-title"},J={class:"checkbox-container"},K=["id"],Q=["for"],W={class:"form-section route-section"},X={class:"route-point origin"},Y={class:"point-details"},Z={class:"route-point destination"},ee={class:"point-details"},te={class:"form-section item-info-section"},oe={class:"info-field"},se=["for"],ne=["id"],ie={class:"info-field"},ae={key:0,class:"upload-prompt"},le=["src"],de={key:2,class:"file-name-display"},re={class:"info-field"},ue=["for"],ce=["id"],pe={class:"form-section task-amount-section"},ve=["for"],me={class:"amount-input-group"},fe=["id"],he={__name:"RequestDetailsForm",props:{index:{type:Number,required:!0},origin:String,destination:String,description:String,orderInfo:String,taskAmount:Number,selected:Boolean},emits:["update:origin","update:destination","update:description","update:orderInfo","update:taskAmount","update:selected"],setup(d,{emit:i}){const a=d,n=i,v=f({get:()=>a.origin,set:o=>n("update:origin",o)}),p=f({get:()=>a.destination,set:o=>n("update:destination",o)}),m=f({get:()=>a.description,set:o=>n("update:description",o)}),c=f({get:()=>a.orderInfo,set:o=>n("update:orderInfo",o)}),s=f({get:()=>a.taskAmount,set:o=>{const t=parseFloat(o);n("update:taskAmount",isNaN(t)?null:t)}}),r=f({get:()=>a.selected,set:o=>n("update:selected",o)}),u=g(null),b=g(""),_=g(""),I=()=>{var o;(o=u.value)==null||o.click()},R=o=>{var l;const t=(l=o.target.files)==null?void 0:l[0];if(t){b.value=t.name;const U=new FileReader;U.onload=V=>{_.value=V.target.result},U.readAsDataURL(t),console.log("Selected file:",t)}else b.value="",_.value=""};return(o,t)=>(k(),h("div",P,[e("div",z,[e("span",G,"委托 "+q(d.index+1),1),e("div",J,[x(e("input",{type:"checkbox",id:"task-selected-checkbox-"+d.index,"onUpdate:modelValue":t[0]||(t[0]=l=>r.value=l),class:"custom-checkbox"},null,8,K),[[N,r.value]]),e("label",{for:"task-selected-checkbox-"+d.index,class:"checkbox-label"},null,8,Q)])]),e("div",W,[e("div",X,[t[6]||(t[6]=e("div",{class:"point-icon-wrapper"},[e("div",{class:"point-icon origin-icon"},"起"),e("div",{class:"route-connector"})],-1)),e("div",Y,[x(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=l=>v.value=l),placeholder:"选择添加起点，填写详细信息 (如蓝田北门外卖柜)",class:"form-textarea",rows:"3"},null,512),[[w,v.value]])])]),e("div",Z,[t[7]||(t[7]=e("div",{class:"point-icon-wrapper"},[e("div",{class:"point-icon destination-icon"},"终")],-1)),e("div",ee,[x(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=l=>p.value=l),placeholder:"选择添加终点，填写详细信息 (如青溪一舍大厅)",class:"form-textarea",rows:"3"},null,512),[[w,p.value]])])])]),e("div",te,[e("div",oe,[e("label",{for:"item-description-"+d.index},"物品描述:",8,se),x(e("textarea",{id:"item-description-"+d.index,"onUpdate:modelValue":t[3]||(t[3]=l=>m.value=l),placeholder:"例如：商家名称+商品名称",class:"form-textarea",rows:"2"},null,8,ne),[[w,m.value]])]),e("div",ie,[t[9]||(t[9]=e("label",null,"订单截图:",-1)),e("div",{class:"screenshot-upload-area",onClick:I},[e("input",{type:"file",ref:l=>u.value=l,onChange:R,style:{display:"none"},accept:"image/*"},null,544),_.value?y("",!0):(k(),h("div",ae,t[8]||(t[8]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e("polyline",{points:"17 8 12 3 7 8"}),e("line",{x1:"12",y1:"3",x2:"12",y2:"15"})],-1),e("span",null,"点击上传图片",-1)]))),_.value?(k(),h("img",{key:1,src:_.value,alt:"截图预览",class:"image-preview"},null,8,le)):y("",!0),b.value&&!_.value?(k(),h("span",de,q(b.value),1)):y("",!0)])]),e("div",re,[e("label",{for:"order-info-"+d.index},"取件信息:",8,ue),x(e("textarea",{id:"order-info-"+d.index,"onUpdate:modelValue":t[4]||(t[4]=l=>c.value=l),placeholder:"例如：外卖柜号, 取件码, 手机号后四位",class:"form-textarea",rows:"3"},null,8,ce),[[w,c.value]])])]),e("div",pe,[e("label",{for:"task-amount-input-"+d.index},"委托金额:",8,ve),e("div",me,[x(e("input",{type:"number",id:"task-amount-input-"+d.index,"onUpdate:modelValue":t[5]||(t[5]=l=>s.value=l),placeholder:"0.00",step:"0.01",min:"0"},null,8,fe),[[w,s.value]]),t[10]||(t[10]=e("span",null,"元",-1))])])]))}},ke=A(he,[["__scopeId","data-v-31c8b10f"]]),ge={class:"checkout-bar-container"},_e={class:"checkout-bar-content"},xe={class:"left-actions"},be={class:"select-all"},we={class:"right-actions"},Ae={class:"total-amount"},Ie={class:"amount-value"},Re=["disabled"],ye={__name:"CheckoutBar",props:{totalTaskAmount:{type:Number,default:0}},setup(d){const i=d,a=S(),n=f({get:()=>a.requests.length>0&&a.requests.every(s=>s.selected),set:s=>{a.toggleSelectAll(s)}}),v=f(()=>i.totalTaskAmount.toFixed(2)),p=f(()=>i.totalTaskAmount<=0),m=()=>{console.log("Select coupon clicked")},c=()=>{p.value||console.log("Checkout clicked with total:",i.totalTaskAmount)};return(s,r)=>(k(),h("div",ge,[e("div",_e,[e("div",xe,[e("div",be,[x(e("input",{type:"checkbox",id:"select-all-checkbox","onUpdate:modelValue":r[0]||(r[0]=u=>n.value=u),class:"custom-checkbox"},null,512),[[N,n.value]]),r[1]||(r[1]=e("label",{for:"select-all-checkbox"},"全选",-1))]),e("div",{class:"coupon-select",onClick:m},r[2]||(r[2]=[e("span",null,"选择卡券",-1),e("span",{class:"coupon-arrow"},[e("svg",{width:"12",height:"7",viewBox:"0 0 12 7",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M1 1L6 6L11 1",stroke:"#E63C3C","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})])],-1)]))]),e("div",we,[e("div",Ae,[r[3]||(r[3]=F(" 共计: ")),e("span",Ie,q(v.value)+"元",1)]),e("button",{class:"checkout-button",onClick:c,disabled:p.value},"结算",8,Re)])])]))}},Ce=A(ye,[["__scopeId","data-v-f1ffcb96"]]),qe={class:"create-request-view"},Ue={class:"view-header"},$e={class:"form-content-wrapper"},Ne={key:0,class:"empty-state"},Se={key:1},Ve={__name:"PublishView",setup(d){const i=S();M(()=>{i.requests.length===0&&i.addRequest()});const a=f(()=>i.requests.reduce((m,c)=>{const s=parseFloat(c.amount);return m+(isNaN(s)?0:s)},0)),n=()=>{i.addRequest()},v=m=>{i.removeRequest(m)},p=()=>{console.log("Individual task amount updated. New total:",a.value)};return(m,c)=>(k(),h("div",qe,[e("div",Ue,[C(H,{onAddRequestClicked:n})]),e("div",$e,[$(i).requests.length===0?(k(),h("div",Ne,c[0]||(c[0]=[e("p",null,"暂无委托，请点击上方按钮添加。",-1)]))):(k(),h("div",Se,[(k(!0),h(D,null,O($(i).requests,(s,r)=>(k(),h("div",{key:s.id||r,class:"request-item-container"},[C(ke,{"request-id":s.id,index:r,origin:s.origin,"onUpdate:origin":u=>s.origin=u,destination:s.destination,"onUpdate:destination":u=>s.destination=u,description:s.description,"onUpdate:description":u=>s.description=u,orderInfo:s.orderInfo,"onUpdate:orderInfo":u=>s.orderInfo=u,taskAmount:s.amount,"onUpdate:taskAmount":[u=>s.amount=u,p],onRemoveRequest:u=>v(r)},null,8,["request-id","index","origin","onUpdate:origin","destination","onUpdate:destination","description","onUpdate:description","orderInfo","onUpdate:orderInfo","taskAmount","onUpdate:taskAmount","onRemoveRequest"])]))),128))]))]),C(Ce,{"total-task-amount":a.value},null,8,["total-task-amount"])]))}},Me=A(Ve,[["__scopeId","data-v-151ba041"]]);export{Me as default};
