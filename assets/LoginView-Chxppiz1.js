import{r as u,c,i as m,b as s,w,f as k,j as p,v,t as f,F as V,u as x,k as B,a as _}from"./index-vt05okdP.js";import{H as L}from"./HomeHead-Bw8jz7BN.js";import{B as N}from"./BottomNav-CyqcP8Xw.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";const T={class:"auth-container"},q={class:"input-group"},E={class:"input-field-only"},H={key:0,class:"error-message"},I=["disabled"],R=["disabled"],C={__name:"LoginView",setup(D){const i=x(),g=B(),n=u(""),l=u(""),o=u(!1),a=u("");async function b(t,e){return new Promise((r,d)=>{setTimeout(()=>{t==="admin"&&e==="password"?r({success:!0,token:"your-secure-auth-token",user:{name:t}}):d(t&&e?new Error("用户名或密码错误"):new Error("请输入用户名和密码"))},1e3)})}const y=async()=>{if(!n.value||!l.value){a.value="请输入用户名和密码！";return}o.value=!0,a.value="";try{const t=await b(n.value,l.value);if(t.success){localStorage.setItem("authToken",t.token),localStorage.setItem("username",t.user.name);const e=g.query.redirect||{name:"home"};i.push(e)}else a.value=t.message||"登录失败，请重试。"}catch(t){a.value=t.message||"发生未知错误，请稍后再试。"}finally{o.value=!1}},h=()=>{o.value||i.push("/register")};return(t,e)=>(_(),c(V,null,[m(L),s("div",T,[e[3]||(e[3]=s("h2",null,"密码登录",-1)),s("form",{onSubmit:w(y,["prevent"])},[s("div",q,[e[2]||(e[2]=s("span",{class:"input-label"},"昵称",-1)),p(s("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=r=>n.value=r),placeholder:"请输入用户名称",required:""},null,512),[[v,n.value]])]),s("div",E,[p(s("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=r=>l.value=r),placeholder:"请输入密码",required:""},null,512),[[v,l.value]])]),a.value?(_(),c("p",H,f(a.value),1)):k("",!0),s("button",{type:"button",onClick:h,class:"btn btn-secondary",disabled:o.value},"注册",8,I),s("button",{type:"submit",class:"btn btn-primary",disabled:o.value},f(o.value?"登录中...":"登录"),9,R)],32)]),m(N)],64))}},A=S(C,[["__scopeId","data-v-3da91f61"]]);export{A as default};
