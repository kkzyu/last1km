import{c as o,a as s,b as n,m as M,u as w,h as g,f as y,w as $,t as _,r as f,o as D,i as k,p as v,F as b,d as I}from"./index-vt05okdP.js";import{_ as m}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as R}from"./BottomNav-CyqcP8Xw.js";const L=[{id:"rider_1",name:"送餐员喜多郁代",avatar:"/images/avatar1.jpg",stats:{onTimeRate:.98,positiveFeedbackRate:.95,averageDailyOrders:35,likeCount:1250,reviewKeywords:["速度快","态度好","准时","专业","餐品完好","礼貌","高效"]}},{id:"rider_2",name:"送餐员波奇",avatar:"/images/avatar2.jpg",stats:{onTimeRate:.98,positiveFeedbackRate:.95,averageDailyOrders:35,likeCount:1250,reviewKeywords:["速度快","态度好","准时","专业","餐品完好","礼貌","高效"]}},{id:"rider_3",name:"送餐员凉",avatar:"/images/avatar3.jpg",stats:{onTimeRate:.98,positiveFeedbackRate:.95,averageDailyOrders:35,likeCount:1250,reviewKeywords:["速度快","态度好","准时","专业","餐品完好","礼貌","高效"]}},{id:"rider_4",name:"送餐员虹夏",avatar:"/images/avatar4.jpg",stats:{onTimeRate:.98,positiveFeedbackRate:.95,averageDailyOrders:35,likeCount:1250,reviewKeywords:["速度快","态度好","准时","专业","餐品完好","礼貌","高效"]}}],S=[{id:"chat_rider_1",riderId:"rider_1",lastMessage:"您的外卖已经送至青溪4舍711，请及时领取~",minutesAgo:5,unreadCount:2},{id:"chat_rider_2",riderId:"rider_2",lastMessage:"请及时领取…谢谢！",minutesAgo:120,unreadCount:3},{id:"chat_rider_3",riderId:"rider_3",lastMessage:"711。取。",minutesAgo:30,unreadCount:1},{id:"chat_rider_4",riderId:"rider_4",lastMessage:"您的外卖已经送至青溪4舍楼下寄存点，请及时领取~",minutesAgo:15,unreadCount:1}],T={class:"messages-header"},x=["disabled"],A={__name:"MessagesHead",props:{hasUnreadMessages:Boolean},setup(t){return(i,e)=>(s(),o("header",T,[e[2]||(e[2]=n("h3",null,"消息列表",-1)),n("button",{onClick:e[0]||(e[0]=c=>i.$emit("mark-all-read")),disabled:!t.hasUnreadMessages,title:"一键已读","aria-label":"一键已读"},e[1]||(e[1]=[M('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon-broom" data-v-21509f74><path stroke="none" d="M0 0h24v24H0z" fill="none" data-v-21509f74></path><path d="M19.285 14.763a1.973 1.973 0 .01 -2.791 .013l-9.142 -9.142a1.973 1.973 0 0 0 -2.791 -2.791l-.103 .086a1.973 1.973 0 0 0 -.086 2.894l9.142 9.142a1.973 1.973 0 0 0 2.894 .086l.086 -.103a1.973 1.973 0 0 0 -.209 -2.785z" data-v-21509f74></path><path d="M4 21h16" data-v-21509f74></path><path d="M7 21v-2a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v2" data-v-21509f74></path></svg>',1)]),8,x)]))}},B=m(A,[["__scopeId","data-v-21509f74"]]),j={class:"message-list-item"},F=["src","alt"],O={class:"message-content"},H={class:"info-header"},N={class:"rider-name"},K={class:"timestamp"},V={class:"last-message"},E={key:0,class:"unread-badge"},U={__name:"MessageListItem",props:{chat:{type:Object,required:!0}},setup(t){const i=t,e=w(),c=g(()=>{const r=new Date(i.chat.timestamp),l=new Date;return r.toDateString()===l.toDateString()?r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):r.toLocaleDateString()}),h=r=>{e.push({name:"rider-profile",params:{riderId:r}})};return(r,l)=>(s(),o("li",j,[n("img",{src:t.chat.rider.avatar,alt:t.chat.rider.name,class:"avatar",onClick:l[0]||(l[0]=$(p=>h(t.chat.rider.id),["stop"]))},null,8,F),n("div",O,[n("div",H,[n("span",N,_(t.chat.rider.name),1),n("span",K,_(c.value),1)]),n("p",V,_(t.chat.lastMessage),1)]),t.chat.unreadCount>0?(s(),o("div",E,_(t.chat.unreadCount),1)):y("",!0)]))}},z=m(U,[["__scopeId","data-v-68eee54a"]]),P={},q={class:"loading"};function G(t,i){return s(),o("div",q,"加载中...")}const J=m(P,[["render",G],["__scopeId","data-v-99f54059"]]),Q={},W={class:"empty-state"};function X(t,i){return s(),o("div",W,"暂无消息")}const Y=m(Q,[["render",X],["__scopeId","data-v-09054bde"]]),Z={class:"messages-home"},ee={key:2,class:"chat-list"},ae={__name:"MessagesHome",setup(t){const i=w(),e=f([]),c=f(!0),h=async()=>{c.value=!0,await new Promise(a=>setTimeout(a,1e3)),e.value=S.map(a=>({...a,rider:L.find(d=>d.id===a.riderId),timestamp:new Date(Date.now()-a.minutesAgo*60*1e3).toISOString()})),c.value=!1},r=g(()=>[...e.value].sort((a,d)=>new Date(d.timestamp)-new Date(a.timestamp))),l=g(()=>e.value.some(a=>a.unreadCount>0));D(()=>{h()});const p=()=>{e.value.forEach(a=>{a.unreadCount=0}),console.log("所有消息已标记为已读")},C=a=>{const d=e.value.find(u=>u.id===a);d&&(d.unreadCount=0),i.push({name:"chat",params:{chatId:a}})};return(a,d)=>(s(),o("div",Z,[k(B,{"has-unread-messages":l.value,onMarkAllRead:p},null,8,["has-unread-messages"]),c.value?(s(),v(J,{key:0})):e.value.length===0?(s(),v(Y,{key:1})):(s(),o("ul",ee,[(s(!0),o(b,null,I(r.value,u=>(s(),v(z,{key:u.id,chat:u,onClick:te=>C(u.id)},null,8,["chat","onClick"]))),128))])),k(R)]))}},oe=m(ae,[["__scopeId","data-v-5cdad12d"]]);export{oe as default};
